<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{fragment/admin_layout}"
   >

<!-- 연결해야 할 외부 css 파일  -->
<th:block layout:fragment="content_css">
	<link rel="stylesheet" href="/css/content/admin/change_major.css">
</th:block>	

<th:block layout:fragment="content">
	<div class="row container">
		<div class="col-12">
			<div class="row mt-3 mb-3">
				<div class="col-12">
					<h4>1.전과신청 접수현황</h4>
				</div>
			</div>
			<div class="row mb-3">
				<div class="col-12">
					<table class="table align-middle">
						<colgroup>
							<col width="7%">
							<col width="17%">
							<col width="17%">
							<col width="7%">
							<col width="12%">
							<col width="12%">
							<col width="12%">
							<col width="*">
						</colgroup>
						<tr>
							<td>신청일</td>
							<td>
								<input type="date" class="form-control monthDate">
							</td>
							<td>
								<input type="date" class="form-control nowDate">
							</td>
							<td>처리상태</td>
							<td>
								<input type="radio" class="form-check-input" onclick="searchByStatus(this);" value="전체" name="status-1" checked>전체
							</td>
							<td>
								<input type="radio" class="form-check-input" onclick="searchByStatus(this);" value="승인대기" name="status-1">승인대기							
							</td>
							<td>
								<input type="radio" class="form-check-input" onclick="searchByStatus(this);" value="승인완료" name="status-1">승인완료
							</td>
							<td>
								<div class="d-grid">
									<input type="button" class="btn btn-primary" onclick="searchByDate();" value="search">
								</div>
							</td>
						</tr>
					</table>
				</div>
			</div>
			<div class="row text-end">
				<div class="col">
					<span class="ps-span"> ★ 버튼을 클릭하면 신청서를 볼 수 있습니다.</span>
				</div>
			</div>
			<div class="row mb-5">
				<div class="col">
					<table class="table align-middle">
						<colgroup>
							<col width="5%">
							<col width="5%">
							<col width="7%">
							<col width="10%">
							<col width="7%">
							<col width="10%">
							<col width="10%">
							<col width="12%">
							<col width="10%">
							<col width="10%">
							<col width="10%">
						</colgroup>
						<thead>
							<tr>
								<td>
									<input type="checkbox" id="allChk" onclick="allCheckControll(this);" checked class="form-check-input">
								</td>
								<td>No</td>
								<td>이 름</td>
								<td>학 번</td>
								<td>학 년</td>
								<td>전공대학</td>
								<td>전공학과</td>
								<td>변경대학</td>
								<td>변경학과</td>
								<td>신청일</td>
								<td>승인</td>
							</tr>
						</thead>
						<tbody id="changeMajorBody">
							<th:block th:each="dept,state:${deptManageList}">
								<tr>
									<td>
										<input type="hidden" th:id="memApplyNo + ${state.count}" th:value="${dept.applyNo}">
										<input type="hidden" th:id="memNo + ${state.count}" th:value="${dept.memberVO.memNo}">
										<input type="hidden" th:class="deptStatus" th:value="${dept.processStatus}">
										<input type="checkbox" checked th:onclick="checkControll();" th:value="${dept.applyNo}" class="form-check-input checkboxes">
									</td>
									<td>[[${#lists.size(deptManageList) - state.index}]]</td>
									<td>[[${dept.memberVO.memName}]]</td>
									<td>[[${dept.memberVO.memNo}]]</td>
									<td>[[${dept.stuYear}]]학년 &nbsp;[[${dept.stuSem}]]학기</td>
									<td>[[${dept.fromCollName}]]</td>
									<td>[[${dept.fromDeptName}]]</td>
									<td>[[${dept.toCollName}]]</td>
									<td>[[${dept.toDeptName}]]</td>
									<td>[[${dept.applyDate}]]</td>
									<td>
										<th:block th:if="${dept.processStatus == '승인대기'}">
											<div class="d-grid">
												<input type="button" value="승인" th:onclick="acceptChangeMajor([[${state.count}]]);" class="btn btn-primary">
											</div>
										</th:block>
										<th:block th:unless="${dept.processStatus == '승인대기'}">
											<div class="d-grid">
												<input type="button" value="완료" th:onclick="acceptChangeMajor([[${state.count}]]);" class="btn btn-primary">
											</div>
										</th:block>
									</td>
								</tr>
							</th:block>	
						</tbody>
					</table>
				</div>
			</div>
			<div class="row text-center mb-5">
				<div class="col">
					<input type="button" onclick="checkedAccept();" class="btn btn-primary" value="일괄승인">
				</div>
			</div>
			<div class="row mb-3">
				<div class="col">
					<h4>2.복수전공신청 접수현황</h4>
				</div>
			</div>
			<div class="row">
				<div class="col">
					<table class="table align-middle">
						<colgroup>
							<col width="7%">
							<col width="17%">
							<col width="17%">
							<col width="7%">
							<col width="12%">
							<col width="12%">
							<col width="12%">
							<col width="*">
						</colgroup>
						<tr>
							<td>신청일</td>
							<td>
								<input type="date" class="form-control dbMonthDate">
							</td>
							<td>
								<input type="date" class="form-control dbNowDate">
							</td>
							<td>처리상태</td>
							<td>
								<input type="radio" class="form-check-input" onclick="searchByDoubleStatus('');" value=""  name="status-3" checked>전체
							</td>
							<td>
								<input type="radio" class="form-check-input" onclick="searchByDoubleStatus('승인대기');" value="승인대기" name="status-3">승인대기							
							</td>
							<td>
								<input type="radio" class="form-check-input" onclick="searchByDoubleStatus('승인완료');" value="승인완료"  name="status-3">승인완료
							</td>
							<td>
								<div class="d-grid">
									<input type="button" class="btn btn-primary" onclick="searchByDateDouble();" value="search">
								</div>
							</td>
						</tr>
					</table>
				</div>
			</div>
			<div class="row text-end">
				<div class="col">
					<span class="ps-span"> ★ 버튼을 클릭하면 신청서를 볼 수 있습니다.</span>
				</div>
			</div>
			<div class="row mb-5">
				<div class="col">
					<table class="table align-middle">
						<colgroup>
							<col width="5%">
							<col width="5%">
							<col width="7%">
							<col width="10%">
							<col width="7%">
							<col width="10%">
							<col width="10%">
							<col width="12%">
							<col width="10%">
							<col width="10%">
							<col width="10%">
						</colgroup>
						<thead>
							<tr>
								<td>
									<input type="checkbox" id="dAllCheck" onclick="doubleCheckControll(this);" checked class="form-check-input">
								</td>
								<td>No</td>
								<td>이 름</td>
								<td>학 번</td>
								<td>학 년</td>
								<td>전공대학</td>
								<td>전공학과</td>
								<td>복수전공요청대학</td>
								<td>복수전공요청학과</td>
								<td>신청일</td>
								<td>승인</td>
							</tr>
						</thead>
						<tbody id="doubleTbody">
							<th:block th:each="double,dState :${doubleRequestList}">
								<tr>
									<td>
										<input type="hidden" th:id="dmemApplyNo + ${dState.count}" th:value="${double.applyNo}">
										<input type="hidden" th:id="dmemNo + ${dState.count}" th:value="${double.stuVO.stuNo}">
										<input type="checkbox" checked th:onclick="checkControll();" th:value="${double.applyNo}" th:data-process-status="${double.processStatus}" th:data-stu-no="${double.stuVO.stuNo}" th:data-double-dept-no="${double.doubleMajorDept}" class="form-check-input doubleCheckboxes">
									</td>
									<td>[[${#lists.size(doubleRequestList) - dState.index}]]</td>
									<td>[[${double.memberVO.memName}]]</td>
									<td>[[${double.stuVO.stuNo}]]</td>
									<td>[[${double.stuVO.stuYear}]]학년&nbsp;[[${double.stuVO.stuSem}]]학기</td>
									<td>[[${double.colleageVO.collName}]]</td>
									<td>[[${double.deptVO.deptName}]]</td>
									<td>[[${double.doubleMajorCollName}]]</td>
									<td>[[${double.doubleMajorDeptName}]]</td>
									<td>[[${double.applyDate}]]</td>
									<td>
										<th:block th:if="${double.processStatus == '승인대기'}">
											<div class="d-grid">
												<input type="button" value="승인" th:onclick="acceptDoubleMajor([[${dState.count}]]);" class="btn btn-primary">
											</div>
										</th:block>
										<th:block th:unless="${double.processStatus == '승인대기'}">
											<div class="d-grid">
												<input type="button" value="완료" th:onclick="acceptDoubleMajor([[${dState.count}]]);" class="btn btn-primary">
											</div>
										</th:block>
									</td>
								</tr>
							</th:block>
						</tbody>
					</table>
				</div>
			</div>
			<div class="row text-center mb-5">
				<div class="col">
					<input type="button" value="일괄승인" onclick="checkedByDoubleMajor();" class="btn btn-primary">
				</div>
			</div>
		</div>
	</div>
	
	
<!-- 전과신청 모달 -->
<div class="modal fade" id="majorModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
     <div class="modal-dialog modal-dialog modal-xl">
       <div class="modal-content">
         <div class="modal-header">
           <h1 class="modal-title" ><span style="font-size: 25px; font-weight: bold;">전과 신청서</span></h1>
           <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
         </div>
         <div class="modal-body">
          	<div class="row">
          		<div class="col-10">
          			<table class="table modalTable">
          				<colgroup>
          					<col width="15%">
          					<col width="35%">
          					<col width="15%">
          					<col width="35%">
          				</colgroup>
          				<tr>
          					<td colspan="4" id="memInfo"></td>
          				</tr>
          				<tr>
          					<td>주소</td>
          					<td id="memAddr" colspan="3"></td>
          				</tr>
          				<tr>
          					<td>연락처</td>
          					<td id="memTell" colspan="3"></td>
          				</tr>
          				<tr>
          					<td>학년</td>
          					<td id="memYear"></td>
          					<td>학적</td>
          					<td id="memStatus"></td>
          				</tr>
          				<tr>
          					<td>전공학과</td>
          					<td id="memDept"></td>
          					<td>복수전공</td>
          					<td id="memDbDept"></td>
          				</tr>
          			</table>
          		</div>
          		<div class="col-2">
          			<img id="memImg" src="" width="100%;">
          		</div>
          	</div>
          	<div class="row">
          		<div class="col">
          			<table class="table">
          				<colgroup>
          					<col width="25%">
          					<col width="25%">
          					<col width="25%">
          					<col width="25%">
          				</colgroup>
          				<tr>
          					<td>소속전공대학</td>
          					<td id="fromColl"></td>
          					<td>변경전공대학</td>
          					<td id="toColl"></td>
          				</tr>
          				<tr>
          					<td>소속전공학과</td>
          					<td id="fromDept"></td>
          					<td>변경전공학과</td>
          					<td id="toDept"></td>
          				</tr>
          			</table>
          			<table class="table">
          				<colgroup>
          					<col width="50%">
          					<col width="50%">
          				</colgroup>
          				<tr>
          					<td>신청사유</td>
          					<td id="reason"></td>
          				</tr>
          			</table>
          		</div>
          	</div>
          	<div class="row">
          		<div class="col-12 d-grid">
	          			<input type="button" id="acceptBtn" value="승인" onclick="updateStuInfo();" class="btn btn-primary">
          		</div>
          	</div>
         </div>
       </div>
     </div>
   </div>
<!-- 복수전공 신청 모달  -->   
<div class="modal fade" id="doubleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
     <div class="modal-dialog modal-dialog modal-xl">
       <div class="modal-content">
         <div class="modal-header">
           <h1 class="modal-title" ><span style="font-size: 25px; font-weight: bold;">복수전공 신청서</span></h1>
           <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
         </div>
         <div class="modal-body">
          	<div class="row">
          		<div class="col-10">
          			<table class="table modalTable">
          				<colgroup>
          					<col width="15%">
          					<col width="35%">
          					<col width="15%">
          					<col width="35%">
          				</colgroup>
          				<tr>
          					<td colspan="4" id="doubleMemInfo"></td>
          				</tr>
          				<tr>
          					<td>주소</td>
          					<td id="doubleMemAddr" colspan="3"></td>
          				</tr>
          				<tr>
          					<td>연락처</td>
          					<td id="doubleMemTell" colspan="3"></td>
          				</tr>
          				<tr>
          					<td>학년</td>
          					<td id="doubleMemYear"></td>
          					<td>학적</td>
          					<td id="doubleMemStatus"></td>
          				</tr>
          				<tr>
          					<td>전공학과</td>
          					<td id="doubleMemDept"></td>
          					<td>복수전공</td>
          					<td id="doubleMemDbDept"></td>
          				</tr>
          			</table>
          		</div>
          		<div class="col-2">
          			<img id="doubleMemImg" src="" width="100%;">
          		</div>
          	</div>
          	<div class="row">
          		<div class="col">
          			<table class="table">
          				<colgroup>
          					<col width="50%">
          					<col width="50%">
          				</colgroup>
          				<tr>
          					<td>신청사유</td>
          					<td id="doubleReason"></td>
          				</tr>
          			</table>
          		</div>
          	</div>
          	<div class="row">
          		<div class="col-12 d-grid">
	          			<input type="button" id="acceptDoubleBtn" value="승인" onclick="updateStuInfoByDouble();" class="btn btn-primary">
          		</div>
          	</div>
         </div>
       </div>
     </div>
   </div>

</th:block>

<!-- 연결해야 할 외부 js 파일 -->
<th:block layout:fragment="content_js">
	<script type="text/javascript" src="/js/content/admin/change_major.js"></script>
</th:block>	

</html>